{"version":3,"file":"static/js/Ratings Admin Panel page.4fdfaad6.chunk.js","mappings":"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","sources":["pages/Streams/RatingsAdminPanel/RatingsAdminPanel.styled.js","pages/Streams/RatingsAdminPanel/RatingsAdminPanel.jsx"],"sourcesContent":["import { FormBtn, Input, InputNote } from 'components/LeadForm/LeadForm.styled';\nimport { Form } from 'formik';\nimport styled from 'styled-components';\n\nexport const AdminPanelSection = styled.section`\n  height: max-content;\n  padding: 30px 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nexport const LoginForm = styled(Form)`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 35px;\n`;\n\nexport const LinksForm = styled(Form)`\n  margin: 0 auto;\n\n  display: flex;\n  flex-direction: column;\n  gap: 35px;\n`;\n\nexport const AdminFormBtn = styled(FormBtn)`\n  margin: 0 auto;\n`;\n\nexport const AdminInput = styled(Input)`\n  border: 2px solid var(--main-color);\n`;\n\nexport const AdminTextArea = styled(Input)`\n  border-radius: 0;\n  width: 35vw;\n  height: 75vh;\n  scrollbar-width: thin;\n  background-color: transparent;\n`;\n\nexport const AdminInputNote = styled(InputNote)`\n  position: static;\n  color: var(--main-color);\n  font-size: 24px;\n  font-weight: 700;\n  bottom: -1.1em;\n`;\n","import axios from 'axios';\nimport { Label } from 'components/LeadForm/LeadForm.styled';\nimport { Loader } from 'components/SharedLayout/Loaders/Loader';\nimport { Formik } from 'formik';\nimport { useEffect, useState } from 'react';\nimport * as yup from 'yup';\nimport {\n  AdminFormBtn,\n  AdminInput,\n  AdminInputNote,\n  AdminPanelSection,\n  AdminTextArea,\n  LinksForm,\n  LoginForm,\n} from './RatingsAdminPanel.styled';\n\naxios.defaults.baseURL = 'https://ap-server-8qi1.onrender.com';\nconst setAuthToken = token => {\n  axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n};\n\nconst RatingsAdminPanel = () => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [isUserAdmin, setIsUserAdmin] = useState(false);\n\n  useEffect(() => {\n    document.title = 'Ratings Admin Panel | AP Education';\n\n    const refreshToken = async () => {\n      console.log('token refresher');\n      try {\n        if (localStorage.getItem('isAdmin')) {\n          const res = await axios.post('admins/refresh/users', {});\n          console.log(res);\n          setIsUserAdmin(isAdmin => (isAdmin = true));\n          setAuthToken(res.data.newToken);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    refreshToken();\n  }, [isUserAdmin]);\n\n  const initialLoginValues = {\n    login: '',\n    password: '',\n  };\n\n  const loginSchema = yup.object().shape({\n    login: yup.string().required('Вкажіть логін!'),\n    password: yup.string().required('Введіть пароль!'),\n  });\n\n  const handleLoginSubmit = async (values, { resetForm }) => {\n    setIsLoading(isLoading => (isLoading = true));\n    try {\n      const response = await axios.post('/admins/login/users', values);\n      setAuthToken(response.data.token);\n      setIsUserAdmin(isAdmin => (isAdmin = true));\n      localStorage.setItem('isAdmin', true);\n      resetForm();\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setIsLoading(isLoading => (isLoading = false));\n    }\n  };\n\n  const initialRatingsValues = {\n    period: 'all',\n    rating: '',\n  };\n\n  const initialMonthlyRatingsValues = {\n    period: 'monthly',\n    rating: '',\n  };\n\n  const ratingsSchema = yup.object().shape({\n    rating: yup.string().required('Внеси бали!'),\n  });\n\n  const handleRatingsSubmit = async (values, { resetForm }) => {\n    setIsLoading(isLoading => (isLoading = true));\n    values.rating = JSON.parse(values.rating);\n\n    try {\n      console.log(values);\n      const response = await axios.patch(`/ratings`, values);\n      console.log(response);\n      resetForm();\n      alert('Рейтинги замінилися, молодець');\n    } catch (error) {\n      console.error(error);\n      alert('Щось не прокнуло!');\n    } finally {\n      setIsLoading(isLoading => (isLoading = false));\n    }\n  };\n\n  const handleMonthlyRatingsSubmit = async (values, { resetForm }) => {\n    setIsLoading(isLoading => (isLoading = true));\n    values.rating = JSON.parse(values.rating);\n\n    try {\n      console.log(values);\n      const response = await axios.patch('/ratings', values);\n      console.log(response);\n      resetForm();\n      alert('Рейтинги замінилися, молодець');\n    } catch (error) {\n      console.error(error);\n      alert('Щось не прокнуло!');\n    } finally {\n      setIsLoading(isLoading => (isLoading = false));\n    }\n  };\n\n  return (\n    <>\n      <AdminPanelSection>\n        {!isUserAdmin && (\n          <Formik\n            initialValues={initialLoginValues}\n            onSubmit={handleLoginSubmit}\n            validationSchema={loginSchema}\n          >\n            <LoginForm>\n              <Label>\n                <AdminInput type=\"text\" name=\"login\" placeholder=\"Login\" />\n                <AdminInputNote component=\"p\" name=\"login\" />\n              </Label>\n              <Label>\n                <AdminInput\n                  type=\"password\"\n                  name=\"password\"\n                  placeholder=\"Password\"\n                />\n                <AdminInputNote component=\"p\" name=\"password\" />\n              </Label>\n              <AdminFormBtn type=\"submit\">Залогінитись</AdminFormBtn>\n            </LoginForm>\n          </Formik>\n        )}\n\n        {isUserAdmin && (\n          <Formik\n            initialValues={initialRatingsValues}\n            onSubmit={handleRatingsSubmit}\n            validationSchema={ratingsSchema}\n          >\n            <LinksForm>\n              <Label>\n                <AdminTextArea\n                  type=\"text\"\n                  name=\"rating\"\n                  component=\"textarea\"\n                  placeholder=\"Бали всіх-всіх-всіх за все-все-все\"\n                />\n                <AdminInputNote component=\"p\" name=\"rating\" />\n              </Label>\n              <AdminFormBtn type=\"submit\">\n                Оновити загальний рейтинг\n              </AdminFormBtn>\n            </LinksForm>\n          </Formik>\n        )}\n        {isUserAdmin && (\n          <Formik\n            initialValues={initialMonthlyRatingsValues}\n            onSubmit={handleMonthlyRatingsSubmit}\n            validationSchema={ratingsSchema}\n          >\n            <LinksForm>\n              <Label>\n                <AdminTextArea\n                  type=\"text\"\n                  name=\"rating\"\n                  component=\"textarea\"\n                  placeholder=\"Бали всіх-всіх-всіх за місяць-місяць-місяць\"\n                />\n                <AdminInputNote component=\"p\" name=\"rating\" />\n              </Label>\n              <AdminFormBtn type=\"submit\">\n                Оновити місячний рейтинг\n              </AdminFormBtn>\n            </LinksForm>\n          </Formik>\n        )}\n        {isLoading && <Loader />}\n      </AdminPanelSection>\n    </>\n  );\n};\n\nexport default RatingsAdminPanel"],"names":["AdminPanelSection","styled","_templateObject","_taggedTemplateLiteral","LoginForm","Form","_templateObject2","LinksForm","_templateObject3","AdminFormBtn","FormBtn","_templateObject4","AdminInput","Input","_templateObject5","AdminTextArea","_templateObject6","AdminInputNote","InputNote","_templateObject7","axios","setAuthToken","token","concat","RatingsAdminPanel","isLoading","setIsLoading","useState","isUserAdmin","setIsUserAdmin","useEffect","document","title","async","console","log","localStorage","getItem","res","isAdmin","data","newToken","error","refreshToken","loginSchema","yup","shape","login","required","password","ratingsSchema","rating","_jsx","_Fragment","children","_jsxs","Formik","initialValues","onSubmit","values","_ref","resetForm","response","setItem","validationSchema","Label","type","name","placeholder","component","period","_ref2","JSON","parse","alert","_ref3","Loader"],"sourceRoot":""}