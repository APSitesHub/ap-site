{"version":3,"file":"static/js/Speaking Club Kids redirect page.fcd10bc0.chunk.js","mappings":"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","sources":["pages/Speakings/StreamSpeakingClubKids.jsx"],"sourcesContent":["import axios from 'axios';\nimport { StreamsBackgroundWrapper } from 'components/BackgroundWrapper/BackgroundWrappers';\nimport { Loader } from 'components/SharedLayout/Loaders/Loader';\nimport { LoaderWrapper } from 'components/SharedLayout/Loaders/Loader.styled';\nimport { useEffect, useLayoutEffect, useState } from 'react';\nimport {\n  StreamPlaceHolder,\n  StreamPlaceHolderText,\n  StreamRefreshPageLink,\n  StreamRefreshQuestion,\n  StreamRefreshText,\n  StreamSection,\n} from '../../components/Stream/Stream.styled';\nimport { useLocation } from 'react-router-dom';\n\naxios.defaults.baseURL = 'https://ap-server-8qi1.onrender.com';\n\nconst StreamSpeakingClubKids = () => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [redirectLink, setRedirectLink] = useState('');\n  const [user, setUser] = useState({});\n  const [course, setCourse] = useState('');\n  const [level, setLevel] = useState('');\n  const [isApproved, setIsApproved] = useState(false);\n  const location = useLocation().pathname;\n\n  const page = location.includes('preschool')\n    ? location.replace('/streams-kids/', '').slice(0, -2)\n    : location.includes('pre') ||\n      location.includes('beg') ||\n      location.includes('mid') ||\n      location.includes('high')\n    ? 'kids' + location.replace('/streams-kids/', '').replace('sc', '')\n    : location.replace('/streams-kids/', '').replace('sc', '') + 'kids';\n  const link = page.includes('b1beginnerkids')\n    ? 'b1kidsbeginner'\n    : page.includes('b2beginnerkids')\n    ? 'b2kidsbeginner'\n    : page;\n\n  console.log(41, page, course, level);\n\n  useLayoutEffect(() => {\n    const getLinksRequest = async () => {\n      try {\n        setIsLoading(isLoading => (isLoading = true));\n        setRedirectLink((await axios.get('/speakings')).data[link]);\n        const currentUser = await axios.post('/users/refresh', {\n          mail: localStorage.getItem('mail'),\n        });\n        console.log(51, currentUser.data.user);\n        setUser(\n          user =>\n            (user = {\n              userId: currentUser.data.user.id,\n              name: currentUser.data.user.name,\n              mail: currentUser.data.user.mail,\n              zoomMail: currentUser.data.user.zoomMail,\n              age: currentUser.data.user.age,\n              lang: currentUser.data.user.lang,\n              course: currentUser.data.user.course,\n              crmId: currentUser.data.user.crmId,\n              contactId: currentUser.data.user.contactId,\n              successRate: currentUser.data.user.successRate,\n              temperament: currentUser.data.user.temperament,\n              visited: currentUser.data.user.visited,\n              visitedTime: currentUser.data.user.visitedTime,\n              feedback: currentUser.data.user.feedback,\n            })\n        );\n      } catch (error) {\n        console.log(error);\n      } finally {\n        setIsLoading(isLoading => (isLoading = false));\n      }\n    };\n    getLinksRequest();\n  }, [link]);\n\n  const getLanguageFromLocation = location => {\n    if (location.includes('de') || location.includes('deutsch')) {\n      return 'dekids';\n    } else if (location.includes('pl') || location.includes('polski')) {\n      return 'plkids';\n    } else {\n      return 'enkids';\n    }\n  };\n  const lang = getLanguageFromLocation(location);\n\n  useEffect(() => {\n    document.title = `Практичне заняття | AP Education`;\n    const sendUserInfo = async () => {\n      try {\n        setCourse(async course => {\n          course = page.includes('high')\n            ? (await axios.get('/timetable')).data.filter(\n                timetable =>\n                  timetable.course.includes('high') && lang === timetable.lang\n              )[0].course\n            : (await axios.get('/timetable')).data.filter(\n                timetable =>\n                  page.includes(timetable.level) && lang === timetable.lang\n              )[0].course;\n        });\n\n        setLevel(async level => {\n          level = (await axios.get('/timetable')).data.filter(\n            timetable =>\n              lang === timetable.lang &&\n              (user.course === timetable.course ||\n                user.course\n                  ?.split('/')\n                  .some(singleCourse => singleCourse === timetable.course))\n          )[0].level;\n        });\n\n        console.log(user.userId);\n        const existingUser = await axios.get(`/speakingusers/${user.userId}`);\n        console.log('existingUser', existingUser);\n        console.log(103, user);\n\n        const res = !existingUser.data\n          ? await axios.post('/speakingusers/new', user)\n          : await axios.put(`/speakingusers/${user.userId}`, user);\n\n        res.data._id && setIsApproved(true);\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    sendUserInfo();\n  }, [user, page, lang]);\n\n  return (\n    <>\n      <StreamSection>\n        <StreamsBackgroundWrapper>\n          {isLoading && (\n            <LoaderWrapper>\n              <Loader />\n            </LoaderWrapper>\n          )}\n          <StreamPlaceHolder>\n            <StreamPlaceHolderText>\n              Привіт! <br />\n              Будь ласка, зачекайте, незабаром вас переадресує на практичне\n              заняття в Zoom\n            </StreamPlaceHolderText>\n            <StreamRefreshText>\n              <StreamRefreshQuestion>\n                Очікуєте занадто довго?\n              </StreamRefreshQuestion>\n              <StreamRefreshPageLink onClick={() => window.location.reload()}>\n                Натисніть сюди, щоб оновити сторінку\n              </StreamRefreshPageLink>\n            </StreamRefreshText>\n          </StreamPlaceHolder>\n          {redirectLink && isApproved && window.location.replace(redirectLink)}\n        </StreamsBackgroundWrapper>\n      </StreamSection>\n    </>\n  );\n};\n\nexport default StreamSpeakingClubKids;\n"],"names":["axios","StreamSpeakingClubKids","isLoading","setIsLoading","useState","redirectLink","setRedirectLink","user","setUser","course","setCourse","level","setLevel","isApproved","setIsApproved","location","useLocation","pathname","page","includes","replace","slice","link","console","log","useLayoutEffect","async","data","currentUser","mail","localStorage","getItem","userId","id","name","zoomMail","age","lang","crmId","contactId","successRate","temperament","visited","visitedTime","feedback","error","getLinksRequest","getLanguageFromLocation","useEffect","document","title","filter","timetable","_user$course","split","some","singleCourse","existingUser","concat","_id","sendUserInfo","_jsx","_Fragment","children","StreamSection","_jsxs","StreamsBackgroundWrapper","LoaderWrapper","Loader","StreamPlaceHolder","StreamPlaceHolderText","StreamRefreshText","StreamRefreshQuestion","StreamRefreshPageLink","onClick","window","reload"],"sourceRoot":""}