"use strict";(self.webpackChunkap_education=self.webpackChunkap_education||[]).push([[8569],{247:(e,s,t)=>{t.r(s),t.d(s,{default:()=>m});var n=t(55294),i=t(97723),a=t(8313),r=t(55705),c=t(72791),o=t(8007),d=t(31356),l=t(80184);n.Z.defaults.baseURL="https://ap-server-8qi1.onrender.com";const h=e=>{n.Z.defaults.headers.common.Authorization="Bearer ".concat(e)},m=()=>{const[e,s]=(0,c.useState)(!1),[t,m]=(0,c.useState)(!1),[j,x]=(0,c.useState)([]),[p,u]=(0,c.useState)(7);(0,c.useEffect)((()=>{document.title="Polish University Users Admin Panel | AP Education";(async()=>{console.log("token refresher");try{if(localStorage.getItem("isAdmin")){const e=await n.Z.post("admins/refresh/users/",{});h(e.data.newToken),m((e=>!0))}}catch(e){console.log(e)}})();return(async()=>{try{if(t){const e=await n.Z.get("/uniusers/admin/");x((s=>[...e.data.reverse()]))}}catch(e){console.error(e)}})(),()=>{}}),[t]);const g=o.Ry().shape({login:o.Z_().required("\u0412\u043a\u0430\u0436\u0456\u0442\u044c \u043b\u043e\u0433\u0456\u043d!"),password:o.Z_().required("\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c!")}),v=e=>{if(e){const s=e.split(".");return s.length>2?Date.parse([s[1],s[0],s[2]].join("/")):Date.parse(e)}};return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(d.Kq,{children:[!t&&(0,l.jsx)(r.J9,{initialValues:{login:"",password:""},onSubmit:async(e,t)=>{let{resetForm:i}=t;s((e=>!0));try{const t=await n.Z.post("/admins/login/users",e);h(t.data.token),m((e=>!0)),localStorage.setItem("isAdmin",!0),i()}catch(a){console.error(a)}finally{s((e=>!1))}},validationSchema:g,children:(0,l.jsxs)(d.U0,{children:[(0,l.jsxs)(i.__,{children:[(0,l.jsx)(d.vD,{type:"text",name:"login",placeholder:"Login"}),(0,l.jsx)(d.aC,{component:"p",name:"login"})]}),(0,l.jsxs)(i.__,{children:[(0,l.jsx)(d.vD,{type:"password",name:"password",placeholder:"Password"}),(0,l.jsx)(d.aC,{component:"p",name:"password"})]}),(0,l.jsx)(d.Gh,{type:"submit",children:"\u0417\u0430\u043b\u043e\u0433\u0456\u043d\u0438\u0442\u0438\u0441\u044c"})]})}),t&&j&&(0,l.jsxs)(d.OD,{children:[(0,l.jsx)(d.az,{children:"\u0421\u043f\u0438\u0441\u043e\u043a \u044e\u0437\u0435\u0440\u0456\u0432 \u0437 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u043c \u0434\u043e \u0443\u0440\u043e\u043a\u0456\u0432"}),(0,l.jsx)("thead",{children:(0,l.jsxs)(d.me,{children:[(0,l.jsx)(d.Sb,{children:"CRM\xa0\u041b\u0456\u0434 \u041a\u043e\u043d\u0442\u0430\u043a\u0442"}),(0,l.jsx)(d.Sb,{children:"\u0406\u043c'\u044f"}),(0,l.jsx)(d.Sb,{children:"\u041f\u043e\u0448\u0442\u0430 (\u043b\u043e\u0433\u0456\u043d)"}),(0,l.jsx)(d.Sb,{children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),(0,l.jsx)(d.Sb,{children:"\u0423\u043d\u0456\u0432\u0435\u0440\u0441\u0438\u0442\u0435\u0442"}),(0,l.jsx)(d.Sb,{children:"ID \u043d\u0430 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0456"}),(0,l.jsx)(d.Sb,{children:"\u0412\u0456\u0434\u0432\u0456\u0434\u0438\u043d\u0438"}),(0,l.jsx)(d.Sb,{children:"\u0412\u0456\u0434\u0432\u0456\u0434\u0438\u043d\u0438 \u0437 \u0447\u0430\u0441\u043e\u043c"})]})}),(0,l.jsx)("tbody",{children:j.map((e=>(0,l.jsxs)(d.me,{children:[(0,l.jsxs)(d.He,{children:[(0,l.jsx)("a",{href:"https://apeducation.kommo.com/leads/detail/".concat(e.crmId),target:"_blank",rel:"noreferrer",children:e.crmId})," ",(0,l.jsx)("a",{href:"https://apeducation.kommo.com/contacts/detail/".concat(e.contactId),target:"_blank",rel:"noreferrer",children:e.contactId})]}),(0,l.jsx)(d.He,{children:e.name}),(0,l.jsx)(d.He,{children:e.mail}),(0,l.jsx)(d.He,{children:e.password}),(0,l.jsx)(d.He,{className:"last-name",children:e.university}),(0,l.jsx)(d.He,{children:e.pupilId}),(0,l.jsx)(d.He,{className:Math.floor((Date.now()-v(e.visited[e.visited.length-1]))/864e5)>p?"attention":"",children:e.visited[e.visited.length-1]}),(0,l.jsx)(d.He,{children:e.visitedTime[e.visitedTime.length-1]?e.visitedTime[e.visitedTime.length-1].match("^202")?new Date(e.visitedTime[e.visitedTime.length-1]).toLocaleString("uk-UA"):new Date(v(e.visitedTime[e.visitedTime.length-1])).toLocaleString("uk-UA",{timeZone:"+06:00"}):""})]},e._id)))})]}),e&&(0,l.jsx)(a.a,{})]})})}}}]);
//# sourceMappingURL=Pedagogium Attendance Panel page.79a84dbf.chunk.js.map