"use strict";(self.webpackChunkap_education=self.webpackChunkap_education||[]).push([[4886],{47360:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var a=r(55294),n=r(60091),s=r(97723),c=r(8313),l=r(55705),o=r(72791),i=r(8007),d=r(31356),m=r(80184);a.Z.defaults.baseURL="https://ap-server-8qi1.onrender.com";const p=e=>{let{userToEdit:t,updateUser:r,closeEditForm:n}=e;const[p,h]=(0,o.useState)(!1),x={crmId:t.crmId||"",contactId:t.contactId||"",name:t.name,mail:t.mail,zoomMail:t.zoomMail||"",password:t.password,pupilId:t.pupilId,marathonNumber:t.marathonNumber||"",adult:t.adult,age:t.age,lang:t.lang,course:t.course,package:t.package,knowledge:t.knowledge,manager:t.manager},u=i.Ry().shape({name:i.Z_().required("\u0406\u043c'\u044f - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u044f\u043a\u0449\u043e \u0456\u043c\u0435\u043d\u0456 \u0437 \u044f\u043a\u043e\u0457\u0441\u044c \u043f\u0440\u0438\u0447\u0438\u043d\u0438 \u043c\u0438 \u043d\u0435 \u0437\u043d\u0430\u0454\u043c\u043e, \u0432\u0432\u0435\u0434\u0456\u0442\u044c N/A"),mail:i.Z_().required("\u041f\u043e\u0448\u0442\u0430 - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435!"),zoomMail:i.Z_(),password:i.Z_().required("\u041f\u0430\u0440\u043e\u043b\u044c - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435!"),crmId:i.Z_().matches(/^[0-9]*$/,"\u041b\u0438\u0448\u0435 \u0446\u0438\u0444\u0440\u0438"),contactId:i.Z_().matches(/^[0-9]*$/,"\u041b\u0438\u0448\u0435 \u0446\u0438\u0444\u0440\u0438"),pupilId:i.Z_().min(6,"\u041d\u0435 \u043c\u0435\u043d\u0448\u0435 6 \u0446\u0438\u0444\u0440").max(7,"\u041d\u0435 \u0431\u0456\u043b\u044c\u0448\u0435 7 \u0446\u0438\u0444\u0440").matches(/^\d{1,7}$/,"\u041b\u0438\u0448\u0435 \u0446\u0438\u0444\u0440\u0438").required("\u041e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u0434\u0438\u0432\u0438\u0442\u0438\u0441\u044c \u043d\u0430 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0456"),marathonNumber:i.Z_().max(1,"\u041d\u0435 \u0431\u0456\u043b\u044c\u0448\u0435 1 \u0446\u0438\u0444\u0440\u0438").matches(/[12]/,"\u041b\u0438\u0448\u0435 \u0446\u0438\u0444\u0440\u0438 1 \u0430\u0431\u043e 2"),age:i.Z_().required("\u0412\u0456\u043a - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u044f\u043a\u0449\u043e \u0432\u0456\u043a\u0443 \u0437 \u044f\u043a\u043e\u0457\u0441\u044c \u043f\u0440\u0438\u0447\u0438\u043d\u0438 \u043c\u0438 \u043d\u0435 \u0437\u043d\u0430\u0454\u043c\u043e, \u0432\u0432\u0435\u0434\u0456\u0442\u044c N/A"),lang:i.Z_().optional().matches(/^[A-Za-z0-9/]+$/,"\u041b\u0438\u0448\u0435 \u043b\u0430\u0442\u0438\u043d\u0441\u044c\u043a\u0456 \u043b\u0456\u0442\u0435\u0440\u0438"),course:i.Z_().required("\u041e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u043e\u0432\u0438\u0445 \u044e\u0437\u0435\u0440\u0456\u0432 \u0430\u0431\u043e \u043d\u0435\u0440\u043e\u0437\u043f\u043e\u0434\u0456\u043b\u0435\u043d\u0438\u0445 \u043a\u043e\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456\u0432 \u0432\u0432\u0435\u0434\u0456\u0442\u044c 0"),package:i.Z_().optional(),knowledge:i.Z_().optional().matches(/^[A-Za-z0-9/]+$/,"\u041b\u0438\u0448\u0435 \u043b\u0430\u0442\u0438\u043d\u0441\u044c\u043a\u0456 \u043b\u0456\u0442\u0435\u0440\u0438"),manager:i.Z_().required("\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u0432\u0432\u0435\u0434\u0456\u0442\u044c \u043f\u0440\u0456\u0437\u0432\u0438\u0449\u0435")});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(l.J9,{initialValues:x,onSubmit:async(e,s)=>{let{resetForm:c}=s;h((e=>!0)),e.name=e.name.trim().trimStart(),e.mail=e.mail.toLowerCase().trim().trimStart(),e.zoomMail=e.zoomMail.toLowerCase().trim().trimStart(),e.password=e.password.trim().trimStart(),e.pupilId=e.pupilId.trim().trimStart(),e.marathonNumber=e.marathonNumber.trim().trimStart(),e.crmId=e.crmId&&"number"!==typeof e.crmId?+e.crmId.trim().trimStart():"number"===typeof e.crmId?e.crmId:void 0,e.contactId=e.contactId&&"number"!==typeof e.contactId?+e.contactId.trim().trimStart():"number"===typeof e.contactId?e.contactId:void 0,e.age=e.age.trim().trimStart(),e.adult=+e.age>18,e.lang=e.lang.toLowerCase().trim().trimStart(),e.package=void 0===e.package?"":e.package.toLowerCase().trim().trimStart(),e.course=void 0===e.course?"":e.course.toLowerCase().trim().trimStart(),e.knowledge=void 0===e.knowledge?"":e.knowledge.toLowerCase().trim().trimStart(),e.manager=e.manager.toLowerCase().trim().trimStart();try{const s=await a.Z.put("/users/".concat(t._id),e);console.log(s),c(),alert("\u042e\u0437\u0435\u0440\u0430 \u0432\u0456\u0434\u0440\u0435\u0434\u0430\u0433\u043e\u0432\u0430\u043d\u043e"),r(t._id,e),n()}catch(l){console.error(l),alert("\u0414\u0435\u0441\u044c \u044f\u043a\u0430\u0441\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 - \u043a\u043b\u0430\u0446\u0430\u0439 F12, \u0440\u043e\u0431\u0438 \u0441\u043a\u0440\u0456\u043d \u043a\u043e\u043d\u0441\u043e\u043b\u0456, \u0432\u0456\u0434\u043f\u0440\u0430\u0432\u043b\u044f\u0439 \u041a\u0438\u0440\u0438\u043b\u0443")}finally{h((e=>!1))}},validationSchema:u,children:(0,m.jsxs)(d.jr,{children:[(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"name",placeholder:"\u041f\u0440\u0456\u0437\u0432\u0438\u0449\u0435 \u0442\u0430 \u0456\u043c'\u044f"}),(0,m.jsx)(d.aC,{component:"p",name:"name"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"email",name:"mail",placeholder:"\u0415\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430 \u043f\u043e\u0448\u0442\u0430 (\u043b\u043e\u0433\u0456\u043d)"}),(0,m.jsx)(d.aC,{component:"p",name:"mail"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"email",name:"zoomMail",placeholder:"Zoom-\u043f\u043e\u0448\u0442\u0430"}),(0,m.jsx)(d.aC,{component:"p",name:"zoomMail"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),(0,m.jsx)(d.aC,{component:"p",name:"password"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"crmId",placeholder:"ID \u043b\u0456\u0434\u0430 \u0432 CRM"}),(0,m.jsx)(d.aC,{component:"p",name:"crmId"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"contactId",placeholder:"ID \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u0443 \u0432 CRM"}),(0,m.jsx)(d.aC,{component:"p",name:"contactId"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"pupilId",placeholder:"ID \u0443\u0447\u043d\u044f \u043d\u0430 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0456"}),(0,m.jsx)(d.aC,{component:"p",name:"pupilId"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"marathonNumber",placeholder:"\u2116 \u043c\u0430\u0440\u0430\u0444\u043e\u043d\u0443 \u043d\u0430 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0456"}),(0,m.jsx)(d.aC,{component:"p",name:"marathonNumber"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"age",placeholder:"\u0412\u0456\u043a"}),(0,m.jsx)(d.aC,{component:"p",name:"age"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"lang",placeholder:"\u041c\u043e\u0432\u0430"}),(0,m.jsx)(d.aC,{component:"p",name:"lang"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"course",placeholder:"\u041f\u043e\u0442\u0456\u043a"}),(0,m.jsx)(d.aC,{component:"p",name:"course"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"package",placeholder:"\u041f\u0430\u043a\u0435\u0442 \u043f\u043e\u0441\u043b\u0443\u0433"}),(0,m.jsx)(d.aC,{component:"p",name:"package"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"knowledge",placeholder:"\u0420\u0456\u0432\u0435\u043d\u044c \u0437\u043d\u0430\u043d\u044c"}),(0,m.jsx)(d.aC,{component:"p",name:"knowledge"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"manager",placeholder:"\u041f\u0440\u0456\u0437\u0432\u0438\u0449\u0435 \u0432\u0456\u0434\u043f\u043e\u0432\u0456\u0434\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0430"}),(0,m.jsx)(d.aC,{component:"p",name:"manager"})]}),(0,m.jsx)(d.Gh,{type:"submit",children:"\u041f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438 \u0437\u043c\u0456\u043d\u0438"})]})}),p&&(0,m.jsx)(c.a,{})]})};a.Z.defaults.baseURL="https://ap-server-8qi1.onrender.com";const h=e=>{a.Z.defaults.headers.common.Authorization="Bearer ".concat(e)},x=[1,3,7,14,30],u=()=>{const[e,t]=(0,o.useState)(!1),[r,u]=(0,o.useState)(!1),[j,g]=(0,o.useState)([]),[_,v]=(0,o.useState)([]),[w,I]=(0,o.useState)([]),[k,S]=(0,o.useState)([]),[f,C]=(0,o.useState)([]),[y,b]=(0,o.useState)(!1),[D,Z]=(0,o.useState)({}),[L,N]=(0,o.useState)(7),[M,z]=(0,o.useState)(!1),[q,A]=(0,o.useState)(!1),[H,R]=(0,o.useState)(!1),[E,F]=(0,o.useState)(!1),[T,U]=(0,o.useState)(!1),$=(0,o.useRef)([]),W=(0,o.useRef)([]),B=(0,o.useRef)([]);(0,o.useEffect)((()=>{document.title="User Admin Panel | AP Education";(async()=>{console.log("token refresher");try{if(localStorage.getItem("isAdmin")){const e=await a.Z.post("admins/refresh/users/",{});h(e.data.newToken),u((e=>!0))}}catch(e){console.log(e)}})();(async()=>{try{if(r){const e=await a.Z.get("/users/admin/");g((t=>[...e.data.reverse()])),$.current=[...e.data.reverse()],v((t=>[...e.data.map((e=>e.manager)).filter(((e,t,r)=>r.indexOf(e)===t)).sort()])),I((t=>[...e.data.map((e=>e.knowledge)).filter(((e,t,r)=>r.indexOf(e)===t)).sort()])),S((t=>[...e.data.map((e=>e.course)).filter(((e,t,r)=>r.indexOf(e)===t)).sort()])),C((t=>[...e.data.map((e=>e.lang)).filter(((e,t,r)=>r.indexOf(e)===t)).sort()]))}}catch(e){console.error(e)}})();const e=e=>{"Escape"===e.code&&X()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[r]);const O=i.Ry().shape({login:i.Z_().required("\u0412\u043a\u0430\u0436\u0456\u0442\u044c \u043b\u043e\u0433\u0456\u043d!"),password:i.Z_().required("\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c!")}),P=e=>{if(e){const t=e.split(".");return t.length>2?Date.parse([t[1],t[0],t[2]].join("/")):Date.parse(e)}},G=e=>{""===e&&0===W.current.length?(g((e=>[...$.current])),W.current=[]):W.current.length>0&&0===B.current.length?(g((t=>[...W.current.filter((t=>t.manager===e))])),B.current=[...W.current.filter((t=>t.manager===e))]):(console.log("managers else"),console.log(B),g((t=>[...$.current.filter((t=>t.manager===e))])),W.current=[...$.current.filter((t=>t.manager===e))],B.current=[...$.current.filter((t=>t.manager===e))],console.log(B))},J=e=>{""===e&&0===W.current.length?(g((e=>[...$.current])),W.current=[]):W.current.length>0&&0===B.current.length?(g((t=>[...W.current.filter((t=>t.course===e))])),B.current=[...W.current.filter((t=>t.course===e))]):(g((t=>[...$.current.filter((t=>t.course===e))])),W.current=[...$.current.filter((t=>t.course===e))],B.current=[...$.current.filter((t=>t.course===e))])},V=e=>{""===e&&0===W.current.length?(g((e=>[...$.current])),W.current=[]):W.current.length>0&&0===B.current.length?(g((t=>[...W.current.filter((t=>t.lang===e))])),B.current=[...W.current.filter((t=>t.lang===e))]):(g((t=>[...$.current.filter((t=>t.lang===e))])),W.current=[...$.current.filter((t=>t.lang===e))],B.current=[...$.current.filter((t=>t.lang===e))])},K=e=>{""===e&&0===W.current.length?(console.log("current === '' && sortedUsers.current.length === 0"),g((e=>[...$.current])),W.current=[]):B.current.length>0?g((t=>[...B.current.filter((t=>t.visited.length>0?(Date.now()-P(t.visited[t.visited.length-1]))/864e5>e:0)).sort(((e,t)=>(P(e.visited[e.visited.length-1])||0)-(P(t.visited[t.visited.length-1])||0)))])):(console.log("else"),g((t=>[...$.current.filter((t=>t.visited.length>0?(Date.now()-P(t.visited[t.visited.length-1]))/864e5>e:0)).sort(((e,t)=>(P(t.visited[t.visited.length-1])||0)-(P(e.visited[e.visited.length-1])||0)))])))},Q=e=>{""===e&&0===W.current.length?(g((e=>[...$.current])),W.current=[]):W.current.length>0&&0===B.current.length?(g((t=>[...W.current.filter((t=>t.knowledge===e))])),B.current=[...W.current.filter((t=>t.knowledge===e))]):(g((t=>[...$.current.filter((t=>t.knowledge===e))])),W.current=[...$.current.filter((t=>t.knowledge===e))],B.current=[...$.current.filter((t=>t.knowledge===e))])},Y=i.Ry().shape({name:i.Z_().required("\u0406\u043c'\u044f - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u044f\u043a\u0449\u043e \u0456\u043c\u0435\u043d\u0456 \u0437 \u044f\u043a\u043e\u0457\u0441\u044c \u043f\u0440\u0438\u0447\u0438\u043d\u0438 \u043c\u0438 \u043d\u0435 \u0437\u043d\u0430\u0454\u043c\u043e, \u0432\u0432\u0435\u0434\u0456\u0442\u044c N/A"),mail:i.Z_().required("\u041f\u043e\u0448\u0442\u0430 - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435!"),zoomMail:i.Z_(),password:i.Z_().required("\u041f\u0430\u0440\u043e\u043b\u044c - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435!"),crmId:i.Z_().matches(/^[0-9]*$/,"\u041b\u0438\u0448\u0435 \u0446\u0438\u0444\u0440\u0438"),contactId:i.Z_().matches(/^[0-9]*$/,"\u041b\u0438\u0448\u0435 \u0446\u0438\u0444\u0440\u0438"),pupilId:i.Z_().min(6,"\u041d\u0435 \u043c\u0435\u043d\u0448\u0435 6 \u0446\u0438\u0444\u0440").max(7,"\u041d\u0435 \u0431\u0456\u043b\u044c\u0448\u0435 7 \u0446\u0438\u0444\u0440").matches(/^\d{1,7}$/,"\u041b\u0438\u0448\u0435 \u0446\u0438\u0444\u0440\u0438").required("\u041e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u0434\u0438\u0432\u0438\u0442\u0438\u0441\u044c \u043d\u0430 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0456"),marathonNumber:i.Z_().max(1,"\u041d\u0435 \u0431\u0456\u043b\u044c\u0448\u0435 1 \u0446\u0438\u0444\u0440\u0438").matches(/[12]/,"\u041b\u0438\u0448\u0435 \u0446\u0438\u0444\u0440\u0438 1 \u0430\u0431\u043e 2"),age:i.Z_().required("\u0412\u0456\u043a - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u044f\u043a\u0449\u043e \u0432\u0456\u043a\u0443 \u0437 \u044f\u043a\u043e\u0457\u0441\u044c \u043f\u0440\u0438\u0447\u0438\u043d\u0438 \u043c\u0438 \u043d\u0435 \u0437\u043d\u0430\u0454\u043c\u043e, \u0432\u0432\u0435\u0434\u0456\u0442\u044c N/A"),lang:i.Z_().required("\u041c\u043e\u0432\u0430 - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435").matches(/^[A-Za-z0-9/]+$/,"\u041b\u0438\u0448\u0435 \u043b\u0430\u0442\u0438\u043d\u0441\u044c\u043a\u0456 \u043b\u0456\u0442\u0435\u0440\u0438"),course:i.Z_().required("\u041e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u043e\u0432\u0438\u0445 \u044e\u0437\u0435\u0440\u0456\u0432 \u0430\u0431\u043e \u043d\u0435\u0440\u043e\u0437\u043f\u043e\u0434\u0456\u043b\u0435\u043d\u0438\u0445 \u043a\u043e\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456\u0432 \u0432\u0432\u0435\u0434\u0456\u0442\u044c 0"),package:i.Z_().optional(),knowledge:i.Z_().optional().matches(/^[A-Za-z0-9/]+$/,"\u041b\u0438\u0448\u0435 \u043b\u0430\u0442\u0438\u043d\u0441\u044c\u043a\u0456 \u043b\u0456\u0442\u0435\u0440\u0438"),manager:i.Z_().required("\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 - \u043e\u0431\u043e\u0432'\u044f\u0437\u043a\u043e\u0432\u0435 \u043f\u043e\u043b\u0435, \u0432\u0432\u0435\u0434\u0456\u0442\u044c \u043f\u0440\u0456\u0437\u0432\u0438\u0449\u0435")}),X=e=>{b(!1)},ee=()=>{R((e=>!e))},te=()=>{F((e=>!e))},re=()=>{U((e=>!e))},ae=()=>{A((e=>!e))},ne=()=>{z((e=>!e))};return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(d.Kq,{children:[!r&&(0,m.jsx)(l.J9,{initialValues:{login:"",password:""},onSubmit:async(e,r)=>{let{resetForm:n}=r;t((e=>!0));try{const r=await a.Z.post("/admins/login/users",e);h(r.data.token),u((e=>!0)),localStorage.setItem("isAdmin",!0),n()}catch(s){console.error(s)}finally{t((e=>!1))}},validationSchema:O,children:(0,m.jsxs)(d.U0,{children:[(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"login",placeholder:"Login"}),(0,m.jsx)(d.aC,{component:"p",name:"login"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"password",name:"password",placeholder:"Password"}),(0,m.jsx)(d.aC,{component:"p",name:"password"})]}),(0,m.jsx)(d.Gh,{type:"submit",children:"\u0417\u0430\u043b\u043e\u0433\u0456\u043d\u0438\u0442\u0438\u0441\u044c"})]})}),r&&(0,m.jsx)(l.J9,{initialValues:{name:"",mail:"",zoomMail:"",password:"",crmId:"",contactId:"",pupilId:"",marathonNumber:"",age:"",adult:!0,lang:"",course:"",package:"",knowledge:"",manager:""},onSubmit:async(e,r)=>{let{resetForm:n}=r;t((e=>!0)),e.name=e.name.trim().trimStart(),e.mail=e.mail.toLowerCase().trim().trimStart(),e.zoomMail=e.zoomMail.toLowerCase().trim().trimStart(),e.password=e.password.trim().trimStart(),e.crmId=e.crmId?+e.crmId.trim().trimStart():void 0,e.contactId=e.contactId?+e.contactId.trim().trimStart():void 0,e.pupilId=e.pupilId.trim().trimStart(),e.marathonNumber=e.marathonNumber.trim().trimStart(),e.age=e.age.trim().trimStart(),e.adult=+e.age>=18,e.lang=e.lang.toLowerCase().trim().trimStart(),e.package=e.package.toLowerCase().trim().trimStart(),e.knowledge=e.knowledge.toLowerCase().trim().trimStart(),e.manager=e.manager.toLowerCase().trim().trimStart();try{const r=await a.Z.post("/users/new",e);console.log(r.data),g((e=>[r.data,...e])),n(),alert("\u042e\u0437\u0435\u0440\u0430 \u0434\u043e\u0434\u0430\u043d\u043e")}catch(s){console.error(s),alert("\u0414\u0435\u0441\u044c \u044f\u043a\u0430\u0441\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 - \u043a\u043b\u0430\u0446\u0430\u0439 F12, \u0440\u043e\u0431\u0438 \u0441\u043a\u0440\u0456\u043d \u043a\u043e\u043d\u0441\u043e\u043b\u0456, \u0432\u0456\u0434\u043f\u0440\u0430\u0432\u043b\u044f\u0439 \u041a\u0438\u0440\u0438\u043b\u0443")}finally{t((e=>!1))}},validationSchema:Y,children:(0,m.jsxs)(d.P_,{children:[(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"name",placeholder:"\u041f\u0440\u0456\u0437\u0432\u0438\u0449\u0435 \u0442\u0430 \u0456\u043c'\u044f"}),(0,m.jsx)(d.aC,{component:"p",name:"name"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"email",name:"mail",placeholder:"\u0415\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430 \u043f\u043e\u0448\u0442\u0430 (\u043b\u043e\u0433\u0456\u043d)"}),(0,m.jsx)(d.aC,{component:"p",name:"mail"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"email",name:"zoomMail",placeholder:"\u0415\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430 \u043f\u043e\u0448\u0442\u0430 (Zoom)"}),(0,m.jsx)(d.aC,{component:"p",name:"zoomMail"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),(0,m.jsx)(d.aC,{component:"p",name:"password"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"crmId",placeholder:"ID \u043b\u0456\u0434\u0430 \u0432 CRM"}),(0,m.jsx)(d.aC,{component:"p",name:"crmId"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"contactId",placeholder:"ID \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u0443 \u0432 CRM"}),(0,m.jsx)(d.aC,{component:"p",name:"contactId"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"pupilId",placeholder:"ID \u0443\u0447\u043d\u044f \u043d\u0430 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0456"}),(0,m.jsx)(d.aC,{component:"p",name:"pupilId"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"marathonNumber",placeholder:"\u2116 \u043c\u0430\u0440\u0430\u0444\u043e\u043d\u0443 \u043d\u0430 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0456"}),(0,m.jsx)(d.aC,{component:"p",name:"marathonNumber"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"age",placeholder:"\u0412\u0456\u043a"}),(0,m.jsx)(d.aC,{component:"p",name:"age"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"lang",placeholder:"\u041c\u043e\u0432\u0430"}),(0,m.jsx)(d.aC,{component:"p",name:"lang"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"course",placeholder:"\u041f\u043e\u0442\u0456\u043a"}),(0,m.jsx)(d.aC,{component:"p",name:"course"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"package",placeholder:"\u041f\u0430\u043a\u0435\u0442 \u043f\u043e\u0441\u043b\u0443\u0433"}),(0,m.jsx)(d.aC,{component:"p",name:"package"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"knowledge",placeholder:"\u0420\u0456\u0432\u0435\u043d\u044c \u0437\u043d\u0430\u043d\u044c"}),(0,m.jsx)(d.aC,{component:"p",name:"knowledge"})]}),(0,m.jsxs)(s.__,{children:[(0,m.jsx)(d.vD,{type:"text",name:"manager",placeholder:"\u041f\u0440\u0456\u0437\u0432\u0438\u0449\u0435 \u0432\u0456\u0434\u043f\u043e\u0432\u0456\u0434\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0430"}),(0,m.jsx)(d.aC,{component:"p",name:"manager"})]}),(0,m.jsx)(d.Gh,{type:"submit",children:"\u0414\u043e\u0434\u0430\u0442\u0438 \u044e\u0437\u0435\u0440\u0430"})]})}),r&&j&&(0,m.jsxs)(d.OD,{children:[(0,m.jsx)(d.az,{children:"\u0421\u043f\u0438\u0441\u043e\u043a \u044e\u0437\u0435\u0440\u0456\u0432 \u0437 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u043c \u0434\u043e \u0443\u0440\u043e\u043a\u0456\u0432"}),(0,m.jsx)("thead",{children:(0,m.jsxs)(d.me,{children:[(0,m.jsx)(d.Sb,{children:"CRM\xa0\u041b\u0456\u0434 \u041a\u043e\u043d\u0442\u0430\u043a\u0442"}),(0,m.jsx)(d.Sb,{children:"\u0406\u043c'\u044f"}),(0,m.jsx)(d.Sb,{children:"\u041f\u043e\u0448\u0442\u0430 (\u043b\u043e\u0433\u0456\u043d)"}),(0,m.jsx)(d.Sb,{children:"Zoom-\u043f\u043e\u0448\u0442\u0430"}),(0,m.jsx)(d.Sb,{children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),(0,m.jsx)(d.Sb,{children:"ID \u043d\u0430 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0456"}),(0,m.jsx)(d.Sb,{children:"\u041d\u043e\u043c\u0435\u0440 \u043c\u0430\u0440\u0430\u0444\u043e\u043d\u0443"}),(0,m.jsx)(d.Sb,{children:"\u042e\u0437\u0435\u0440\u0430 \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043e"}),(0,m.jsx)(d.Sb,{children:(0,m.jsxs)(d.xu,{children:["\u0412\u0456\u0434\u0432\u0456\u0434\u0438\u043d\u0438",(0,m.jsx)(d.Lb,{onClick:ee}),H&&(0,m.jsxs)(d.t2,{children:[x.map(((e,t)=>(0,m.jsx)(d.IW,{onClick:()=>{K(e),N(e),ee()},children:void 0===e?"\u2014":e},t))),(0,m.jsx)(d.IW,{onClick:()=>{K(""),N(7),ee()},children:"\u0412\u0421\u0406"})]}),L]})}),(0,m.jsx)(d.Sb,{children:(0,m.jsx)(d.xu,{children:"\u0412\u0456\u0434\u0432\u0456\u0434\u0438\u043d\u0438 \u0437 \u0447\u0430\u0441\u043e\u043c"})}),(0,m.jsx)(d.Sb,{children:(0,m.jsxs)(d.xu,{children:["\u041c\u043e\u0432\u0430",(0,m.jsx)(d.Lb,{onClick:ae}),q&&(0,m.jsxs)(d.t2,{children:[f.map(((e,t)=>(0,m.jsx)(d.IW,{onClick:()=>{V(e),ae()},children:void 0===e?"\u2014":e},t))),(0,m.jsx)(d.IW,{onClick:()=>{V(""),ae()},children:"\u0412\u0421\u0406"})]})]})}),(0,m.jsx)(d.Sb,{children:(0,m.jsxs)(d.xu,{children:["\u041f\u043e\u0442\u0456\u043a",(0,m.jsx)(d.Lb,{onClick:re}),T&&(0,m.jsxs)(d.t2,{children:[k.map(((e,t)=>(0,m.jsx)(d.IW,{onClick:()=>{J(e),re()},children:void 0===e?"\u2014":e},t))),(0,m.jsx)(d.IW,{onClick:()=>{J(""),re()},children:"\u0412\u0421\u0406"})]})]})}),(0,m.jsx)(d.Sb,{children:(0,m.jsxs)(d.xu,{children:["\u0417\u043d\u0430\u043d\u043d\u044f",(0,m.jsx)(d.Lb,{onClick:te}),E&&(0,m.jsxs)(d.t2,{children:[w.map(((e,t)=>(0,m.jsx)(d.IW,{onClick:()=>{Q(e),te()},children:void 0===e?"\u2014":e},t))),(0,m.jsx)(d.IW,{onClick:()=>{Q(""),te()},children:"\u0412\u0421\u0406"})]})]})}),(0,m.jsx)(d.Sb,{children:"\u041f\u0430\u043a\u0435\u0442 \u043f\u043e\u0441\u043b\u0443\u0433"}),(0,m.jsx)(d.Sb,{className:"filterable",children:(0,m.jsxs)(d.xu,{children:["\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440",(0,m.jsx)(d.Lb,{onClick:ne}),M&&(0,m.jsxs)(d.t2,{children:[_.map(((e,t)=>(0,m.jsx)(d.IW,{onClick:()=>{G(e),ne()},children:void 0===e?"\u2014":e},t))),(0,m.jsx)(d.IW,{onClick:()=>{G(""),ne()},children:"\u0412\u0421\u0406"})]})]})}),(0,m.jsx)(d.Sb,{children:"Edit"}),(0,m.jsx)(d.Sb,{children:"Delete"}),(0,m.jsx)(d.Sb,{children:"Ban"})]})}),(0,m.jsx)("tbody",{children:j.map((e=>{var r;return(0,m.jsxs)(d.me,{children:[(0,m.jsxs)(d.He,{children:[(0,m.jsx)("a",{href:"https://apeducation.kommo.com/leads/detail/".concat(e.crmId),target:"_blank",rel:"noreferrer",children:e.crmId})," ",(0,m.jsx)("a",{href:"https://apeducation.kommo.com/contacts/detail/".concat(e.contactId),target:"_blank",rel:"noreferrer",children:e.contactId})]}),(0,m.jsx)(d.He,{children:e.name}),(0,m.jsx)(d.He,{children:e.mail}),(0,m.jsx)(d.He,{children:e.zoomMail}),(0,m.jsx)(d.He,{children:e.password}),(0,m.jsx)(d.He,{children:e.pupilId}),(0,m.jsx)(d.He,{children:e.marathonNumber}),(0,m.jsx)(d.He,{children:new Date(e.createdAt).toLocaleDateString("uk-UA")}),(0,m.jsx)(d.He,{className:Math.floor((Date.now()-P(e.visited[e.visited.length-1]))/864e5)>L?"attention":"",children:e.visited[e.visited.length-1]}),(0,m.jsx)(d.He,{children:e.visitedTime[e.visitedTime.length-1]?e.visitedTime[e.visitedTime.length-1].match("^202")?new Date(e.visitedTime[e.visitedTime.length-1]).toLocaleString("uk-UA"):new Date(P(e.visitedTime[e.visitedTime.length-1])).toLocaleString("uk-UA",{timeZone:"+06:00"}):""}),(0,m.jsx)(d.He,{children:e.lang}),(0,m.jsx)(d.He,{children:e.course}),(0,m.jsx)(d.He,{className:(null===(r=e.knowledge)||void 0===r?void 0:r.includes("\u0430"))&&"error",children:e.knowledge}),(0,m.jsx)(d.He,{children:e.package}),(0,m.jsx)(d.He,{className:"last-name",children:e.manager}),(0,m.jsx)(d.He,{children:"Dev Acc"===e.name?null:(0,m.jsx)(d.Hx,{onClick:()=>(async e=>{b(!0),Z((t=>j.find((t=>t._id===e))))})(e._id),children:"Edit"})}),(0,m.jsx)(d.He,{children:"Dev Acc"===e.name?null:(0,m.jsx)(d.hj,{onClick:()=>(async e=>{if(t((e=>!0)),window.confirm("\u0422\u043e\u0447\u043d\u043e \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 ".concat(j.find((t=>t._id===e)).name,"?")))try{const r=await a.Z.delete("/users/".concat(e));console.log(r),alert("\u042e\u0437\u0435\u0440\u0430 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043e"),g((t=>[...t.filter((t=>t._id!==e))]))}catch(r){console.error(r),alert("\u0414\u0435\u0441\u044c \u044f\u043a\u0430\u0441\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 - \u043a\u043b\u0430\u0446\u0430\u0439 F12, \u0440\u043e\u0431\u0438 \u0441\u043a\u0440\u0456\u043d \u043a\u043e\u043d\u0441\u043e\u043b\u0456, \u0432\u0456\u0434\u043f\u0440\u0430\u0432\u043b\u044f\u0439 \u041a\u0438\u0440\u0438\u043b\u0443")}finally{t((e=>!1))}else t((e=>!1))})(e._id),children:"Del"})}),(0,m.jsx)(d.He,{children:"Dev Acc"===e.name?null:(0,m.jsx)(d.Q$,{className:e.isBanned?"banned":"not_banned",onClick:()=>(async(e,r)=>{t((e=>!0));try{const n=await a.Z.patch("/users/".concat(e),r?{isBanned:!1}:{isBanned:!0});console.log(n),r?alert("\u042e\u0437\u0435\u0440\u0430 \u0440\u043e\u0437\u0431\u043b\u043e\u043a\u043e\u0432\u0430\u043d\u043e"):alert("\u042e\u0437\u0435\u0440\u0430 \u0437\u0430\u0431\u043b\u043e\u043a\u043e\u0432\u0430\u043d\u043e")}catch(n){console.error(n),alert("\u0414\u0435\u0441\u044c \u044f\u043a\u0430\u0441\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 - \u043a\u043b\u0430\u0446\u0430\u0439 F12, \u0440\u043e\u0431\u0438 \u0441\u043a\u0440\u0456\u043d \u043a\u043e\u043d\u0441\u043e\u043b\u0456, \u0432\u0456\u0434\u043f\u0440\u0430\u0432\u043b\u044f\u0439 \u041a\u0438\u0440\u0438\u043b\u0443")}finally{t((e=>!1))}})(e._id,e.isBanned),children:e.isBanned?"Unban":"Ban"})})]},e._id)}))})]}),y&&(0,m.jsx)(n.Y,{onMouseDown:e=>{"close-on-click"===e.target.id&&b(!1)},id:"close-on-click",children:(0,m.jsx)(p,{userToEdit:D,updateUser:(e,t)=>{const r=j.find((t=>t._id===e));r.name=t.name,r.mail=t.mail,r.zoomMail=t.zoomMail,r.password=t.password,r.pupilId=t.pupilId,r.marathonNumber=t.marathonNumber,r.crmId=t.crmId,r.contactId=t.contactId,r.age=t.age,r.adult=t.adult,r.lang=t.lang,r.package=t.package,r.course=t.course,r.knowledge=t.knowledge,r.manager=t.manager,console.log(r),g((t=>t=t.map(((a,n)=>n===t.findIndex((t=>t._id===e))?r:a))))},closeEditForm:X})}),e&&(0,m.jsx)(c.a,{})]})})}}}]);
//# sourceMappingURL=User Admin Panel page.ecfa7a6c.chunk.js.map